import{a as dt}from"./chunk-ENMPSJXG.js";import{a as ct,b as ut}from"./chunk-5ZLIDYDP.js";import{a as st}from"./chunk-OUHU5IKE.js";import{d as X,f as z}from"./chunk-4VK5QAQ4.js";import"./chunk-OBPBYJ6A.js";import{j as mt,k as pt}from"./chunk-HCD2ASE5.js";import"./chunk-NPBKDSKV.js";import{a as nt,d as at,e as lt}from"./chunk-7GNCTW5R.js";import{P as H}from"./chunk-Y7UIZA4W.js";import"./chunk-EJJBCPAK.js";import"./chunk-ZO4JBRXK.js";import{b as J,d as s,f as K,g as W,h as Y,j as y,l as Z,n as tt,q as et,w as it,x as rt,y as ot}from"./chunk-Y2YOYVZC.js";import{Bb as v,C as T,Cc as Q,Db as b,Ma as c,N as D,Na as d,Ob as a,Qb as G,Wb as B,Yb as _,Zb as R,_b as U,a as x,b as w,ca as k,db as m,ga as q,ib as u,ob as O,p as M,pa as P,qa as h,qb as V,rb as A,sb as n,tb as r,ub as p,vc as j,xa as N,xc as $,yb as C,zc as L}from"./chunk-SPCE6MV4.js";var F=o=>({"is-invalid":o});function ft(o,t){o&1&&(n(0,"span"),a(1," Please enter a product name. "),r())}function vt(o,t){o&1&&(n(0,"span"),a(1," Please enter a quantity. "),r())}function bt(o,t){o&1&&(n(0,"span"),a(1," Please enter a unit price. "),r())}function _t(o,t){if(o&1&&(n(0,"mat-option",14),a(1),r()),o&2){let e=t.$implicit;u("value",e.categoryId),c(),G(" ",e.categoryName," ")}}function Pt(o,t){if(o&1){let e=C();n(0,"button",17),v("click",function(){P(e);let l=b();return h(l.update(l.productForm))}),a(1,"Update"),r()}if(o&2){let e=b();u("disabled",!e.productForm.valid)}}function ht(o,t){if(o&1){let e=C();n(0,"button",18),v("click",function(){P(e);let l=b();return h(l.create(l.productForm))}),a(1,"Add"),r()}}var gt=class o{constructor(t,e,i,l){this.fb=t;this.route=e;this.router=i;this._productsService=l}productForm;errorMessage;ratedProduct;isEdit;productId;updateProduct;categories;categories$;_categoryService=k(dt);closeDialog=new N;ngOnInit(){this.route.queryParams.pipe(D("isEdit")).subscribe(t=>{this.isEdit=t==="true"}),console.log(this.isEdit,"This be edit"),this.categories$=this.getCategories(),this.productForm=this.fb.group({productname:["",s.required],unitPrice:["",s.required],quantity:["",s.required],category:["",s.required],store:new Y({branch:new y(""),code:new y("")})}),this.isEdit&&this.callExistingProduct(),this.productForm.get("productname")?.valueChanges.subscribe(t=>console.log(t))}getCategories(){return this._categoryService.getCategories().pipe(T((t,e)=>(console.log(t),M(t))))}update(t){var e=w(x({},this.updateProduct),{productId:this.productId,productName:t.value.productname,quantityPerUnit:t.value.quantity,unitPrice:t.value.unitPrice,CategoryId:t.value.category});this._productsService.updateProduct(e,this.productId).subscribe(i=>{console.log(i),this.router.navigate(["/products"])})}create(t){console.log(t.value);let e={categoryId:1,discontinued:!1,productId:0,productName:t.value.productname,quantityPerUnit:t.value.quantity,reorderLevel:0,supplierId:1,unitPrice:t.value.unitPrice,unitsInStock:0,unitsOnOrder:0};this._productsService.createProduct(e).subscribe(i=>{console.log(i),this.router.navigate(["/products"])})}callExistingProduct(){let t=this.route.snapshot.paramMap.get("id")??"";this.productId=t,this._productsService.getProduct(t).subscribe(e=>{this.ratedProduct=e,this.updateProduct=this.ratedProduct,this.productForm.get("productname")?.setValue(this.ratedProduct.productName),this.productForm.get("quantity")?.setValue(this.ratedProduct.quantityPerUnit),this.productForm.get("unitPrice")?.setValue(this.ratedProduct.unitPrice)},e=>this.errorMessage=e)}closeDialogBox(){this.router.navigate(["/products"])}static \u0275fac=function(e){return new(e||o)(d(it),d(X),d(z),d(st))};static \u0275cmp=q({type:o,selectors:[["app-product-table-detail"]],outputs:{closeDialog:"closeDialog"},standalone:!0,features:[B],decls:40,vars:17,consts:[[1,"backdrop"],["open",""],[1,"close-dialog",3,"click"],["id","main-wrapper"],["cdkFocusInitial","",3,"formGroup"],[1,"form-group"],[1,"custom-field"],["matInput","","placeholder","","id","name","formControlName","productname",1,"form-control",3,"ngClass"],[1,"invalid-feedback"],[4,"ngIf"],["matInput","","placeholder","","id","name","formControlName","quantity",1,"form-control",3,"ngClass"],["matInput","","placeholder","","id","name","formControlName","unitPrice",1,"form-control",3,"ngClass"],["appearance","fill",1,"custom-field"],["formControlName","category"],[3,"value"],["class","btn btn-success",3,"disabled","click",4,"ngIf"],["class","btn btn-success",3,"click",4,"ngIf"],[1,"btn","btn-success",3,"click","disabled"],[1,"btn","btn-success",3,"click"]],template:function(e,i){if(e&1&&(p(0,"div",0),n(1,"dialog",1)(2,"div",2),v("click",function(){return i.closeDialogBox()}),a(3,"X"),r(),n(4,"div",3)(5,"div")(6,"form",4)(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),a(10,"Product Name"),r(),p(11,"input",7),r(),n(12,"span",8),m(13,ft,2,0,"span",9),r()(),n(14,"div",5)(15,"mat-form-field",6)(16,"mat-label"),a(17,"Quantity"),r(),p(18,"input",10),r(),n(19,"span",8),m(20,vt,2,0,"span",9),r()(),n(21,"div",5)(22,"mat-form-field",6)(23,"mat-label"),a(24,"Unit Price"),r(),p(25,"input",11),r(),n(26,"span",8),m(27,bt,2,0,"span",9),r()(),n(28,"div",5)(29,"mat-form-field",12)(30,"mat-label"),a(31,"Select Product"),r(),n(32,"mat-select",13)(33,"mat-option",14),a(34,"Select Product"),r(),V(35,_t,2,2,"mat-option",14,O),R(37,"async"),r()()(),m(38,Pt,2,1,"button",15)(39,ht,2,0,"button",16),r()()()()),e&2){let l,I,g,E,f,S;c(6),u("formGroup",i.productForm),c(5),u("ngClass",_(11,F,!((l=i.productForm.get("productname"))!=null&&l.valid)&&((l=i.productForm.get("productname"))==null?null:l.touched))),c(2),u("ngIf",(I=i.productForm.get("productname"))==null?null:I.hasError("required")),c(5),u("ngClass",_(13,F,!((g=i.productForm.get("quantity"))!=null&&g.valid)&&((g=i.productForm.get("quantity"))==null?null:g.touched))),c(2),u("ngIf",(E=i.productForm.get("quantity"))==null?null:E.hasError("required")),c(5),u("ngClass",_(15,F,!((f=i.productForm.get("unitPrice"))!=null&&f.valid)&&((f=i.productForm.get("unitPrice"))==null?null:f.touched))),c(2),u("ngIf",(S=i.productForm.get("unitPrice"))==null?null:S.hasError("required")),c(8),A(U(37,9,i.categories$)),c(3),u("ngIf",i.isEdit),c(),u("ngIf",!i.isEdit)}},dependencies:[rt,Z,J,K,W,ot,tt,et,ut,ct,at,nt,lt,pt,mt,H,Q,j,$,L],styles:[".backdrop[_ngcontent-%COMP%]{background-color:#0006;position:fixed;top:0;left:0;width:100%;height:100vh}dialog[_ngcontent-%COMP%]{width:90%;max-width:40rem;background-color:#fff;border-radius:6px;border:none;box-shadow:0 1px 6px #0006;overflow:hidden;padding:1rem;top:5rem}dialog[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:80%}"]})};export{gt as ProductTableDetailComponent};
